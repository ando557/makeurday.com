<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Аутентификация - Make Your Day</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/lucide-static/dist/lucide.min.js"></script>
</head>
<body class="bg-slate-900 text-white">
    <div class="background-container"></div>
    
    <header id="main-header" class="absolute top-0 left-0 right-0 p-4 z-20"></header>
    <template id="header-template">
        <div class="container mx-auto flex justify-between items-center">
            <a href="index.html" class="flex items-center gap-3">
                <img src="logo.png" alt="Logo" class="h-10 w-10 md:h-12 md:w-12 object-contain">
                <span class="text-2xl font-bold tracking-wider main-gradient-text">MakeYourDay</span>
            </a>
            <div class="flex items-center gap-2 md:gap-4">
                <div id="auth-buttons" class="hidden items-center gap-2">
                    <a href="auth.html?mode=login" class="px-4 py-2 text-sm font-medium hover:text-pink-400 transition-colors" data-key="loginBtn">Войти</a>
                    <a href="auth.html?mode=register" class="shine-button bg-pink-600 text-white font-bold py-2 px-5 rounded-full text-sm transition-all duration-300 hover:bg-pink-500 hover:shadow-lg hover:shadow-pink-600/50" data-key="registerBtn">Регистрация</a>
                </div>
                <div id="user-profile" class="hidden items-center gap-3 glass-card-footer p-2 rounded-lg">
                    <a href="account.html" class="flex items-center gap-2 text-right p-2 rounded-md hover:bg-slate-700/50 transition-colors">
                        <div>
                            <span id="profile-username" class="font-bold text-white block text-sm">Username</span>
                            <span id="profile-plan" class="text-xs uppercase font-bold bg-clip-text text-transparent">Free Plan</span>
                        </div>
                         <i data-lucide="user-circle-2" class="w-6 h-6 text-slate-300"></i>
                    </a>
                    <button id="logout-btn" title="Выйти" class="p-2 rounded-md hover:bg-slate-700/50 transition-colors">
                        <i data-lucide="log-out" class="w-5 h-5 text-slate-400 hover:text-white transition-colors"></i>
                    </button>
                </div>
                <div id="theme-switcher-container" class="relative hidden">
                     <button id="theme-switcher-btn" class="glass-card-footer p-2 rounded-lg hover:bg-slate-700/80 transition-colors" title="Сменить тему">
                        <i data-lucide="palette" class="w-5 h-5"></i>
                     </button>
                </div>
                <div id="lang-selector" class="relative">
                    <button id="lang-button" class="flex items-center gap-2 glass-card-footer px-3 py-2 rounded-lg hover:bg-slate-700/80 transition-colors">
                        <i data-lucide="globe" class="w-5 h-5"></i>
                        <span id="current-lang-text" class="text-sm">RU</span>
                        <i data-lucide="chevron-down" id="lang-chevron" class="w-4 h-4 transition-transform duration-300"></i>
                    </button>
                    <div id="lang-dropdown" class="absolute top-full right-0 mt-2 w-32 glass-card-footer rounded-lg overflow-hidden hidden transition-all duration-300 transform origin-top-right scale-95 opacity-0 z-30">
                        <a href="#" class="lang-option block px-4 py-2 text-sm text-white hover:bg-slate-700/80" data-lang="ru">Русский</a>
                        <a href="#" class="lang-option block px-4 py-2 text-sm text-white hover:bg-slate-700/80" data-lang="en">English</a>
                        <a href="#" class="lang-option block px-4 py-2 text-sm text-white hover:bg-slate-700/80" data-lang="es">Español</a>
                        <a href="#" class="lang-option block px-4 py-2 text-sm text-white hover:bg-slate-700/80" data-lang="fr">Français</a>
                    </div>
                </div>
            </div>
        </div>
    </template>

    <div class="relative min-h-screen flex flex-col items-center justify-center p-4 z-10">
        <div class="glass-card w-full max-w-md animate-fade-in-up">
            <h1 id="form-title" class="text-3xl font-bold text-center mb-2 text-transparent bg-clip-text bg-gradient-to-r from-amber-400 via-pink-500 to-purple-500">
                Создать Аккаунт
            </h1>
            <p id="form-subtitle" class="text-slate-400 text-center mb-8">Присоединяйся к нам!</p>

            <form id="auth-form" class="space-y-6">
                <div>
                    <label for="nickname" class="block text-sm font-medium text-slate-300">Никнейм</label>
                    <input type="text" id="nickname" name="nickname" required
                           class="mt-1 block w-full bg-slate-700/50 border border-slate-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-purple-500 focus:border-purple-500">
                </div>
                <div>
                    <label for="password" class="block text-sm font-medium text-slate-300">Пароль</label>
                    <input type="password" id="password" name="password" required
                           class="mt-1 block w-full bg-slate-700/50 border border-slate-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-purple-500 focus:border-purple-500">
                </div>
                <div id="error-message" class="text-red-400 text-sm text-center hidden"></div>
                <div>
                    <button type="submit" id="submit-btn" class="shine-button w-full flex justify-center py-3 px-4 border border-transparent rounded-md shadow-sm text-sm font-bold text-white bg-purple-600 hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500 focus:ring-offset-slate-800">
                        Зарегистрироваться
                    </button>
                </div>
            </form>
             <div class="mt-6 text-center">
                <p id="toggle-mode" class="text-sm text-slate-400">
                    Уже есть аккаунт? <a href="auth.html?mode=login" class="font-medium text-pink-400 hover:text-pink-300">Войти</a>
                </p>
            </div>
        </div>
    </div>
    
    <script src="script.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const form = document.getElementById('auth-form');
            const titleEl = document.getElementById('form-title');
            const subtitleEl = document.getElementById('form-subtitle');
            const submitBtn = document.getElementById('submit-btn');
            const errorMessage = document.getElementById('error-message');
            const toggleModeEl = document.getElementById('toggle-mode');
            
            const urlParams = new URLSearchParams(window.location.search);
            const mode = urlParams.get('mode') || 'register';

            if (mode === 'login') {
                titleEl.textContent = 'Вход в Аккаунт';
                subtitleEl.textContent = 'С возвращением!';
                submitBtn.textContent = 'Войти';
                toggleModeEl.innerHTML = 'Нет аккаунта? <a href="auth.html?mode=register" class="font-medium text-pink-400 hover:text-pink-300">Зарегистрироваться</a>';
            } else {
                 toggleModeEl.innerHTML = 'Уже есть аккаунт? <a href="auth.html?mode=login" class="font-medium text-pink-400 hover:text-pink-300">Войти</a>';
            }

            form.addEventListener('submit', (e) => {
                e.preventDefault();
                errorMessage.classList.add('hidden');

                const nickname = document.getElementById('nickname').value.trim();
                const password = document.getElementById('password').value;

                if (!nickname || !password) {
                    showError('Все поля обязательны!');
                    return;
                }
                
                const usersDB = JSON.parse(localStorage.getItem('makeYourDayUsers')) || {};

                if (mode === 'register') {
                    if (usersDB[nickname]) {
                        showError('Пользователь с таким ником уже существует!');
                    } else {
                        usersDB[nickname] = {
                            password: password,
                            plan: 'free',
                            lang: 'ru',
                            favorites: [],
                            theme: 'default',
                            limitReachedTimestamp: null
                        };
                        localStorage.setItem('makeYourDayUsers', JSON.stringify(usersDB));
                        localStorage.setItem('makeYourDayCurrentUser', nickname);
                        window.location.href = 'index.html';
                    }
                } else { // mode === 'login'
                    const user = usersDB[nickname];
                    if (user && user.password === password) {
                        localStorage.setItem('makeYourDayCurrentUser', nickname);
                        window.location.href = 'index.html';
                    } else if (user) {
                        showError('Неверный пароль.');
                    } else {
                        showError('Пользователь с таким ником не найден.');
                    }
                }
            });

            function showError(message) {
                errorMessage.textContent = message;
                errorMessage.classList.remove('hidden');
            }
        });
    </script>
</body>
</html>